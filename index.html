<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest2.json">
    <title>mObywatel 2.0</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        input {
            display: block;
            margin: 10px auto;
            padding: 10px;
            width: 200px;
        }
        button {
            padding: 10px 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h2>Logowanie</h2>
    <input type="text" id="login" placeholder="Login">
    <input type="password" id="haslo" placeholder="Hasło">
    <button onclick="sprawdzDane()">Zaloguj</button>

    <script>
        // Sprawdzenie, czy strona jest uruchomiona jako PWA i czy jest dodana do ekranu głównego
        if (window.matchMedia('(display-mode: standalone)').matches) {
            if (localStorage.getItem("isPwaAdded") !== "true") {
                localStorage.setItem("isPwaAdded", "true"); // Zapisz, że PWA została dodana
            }
            // Jeśli aplikacja jest PWA, sprawdzamy, czy użytkownik jest zalogowany
            if (sessionStorage.getItem("zalogowany") === "true") {
                window.location.href = "index2.html";
            }
        } else {
            // Zwykła przeglądarka, nigdy nie zapisuj stanu PWA
            localStorage.removeItem("isPwaAdded");
            sessionStorage.removeItem("zalogowany");
        }

        function sprawdzDane() {
            var login = document.getElementById("login").value;
            var haslo = document.getElementById("haslo").value;

            // Lista poprawnych loginów i haseł
            var users = {
                "polak": "418",
                "janek": "1234",
                "kowalski": "5678",
                "admin": "adminpass"
            };

            // Sprawdzenie loginu i hasła
            if (users[login] && users[login] === haslo) {
                // Jeżeli poprawne, w przypadku PWA zapisujemy stan w sessionStorage
                if (window.matchMedia('(display-mode: standalone)').matches) {
                    sessionStorage.setItem("zalogowany", "true");
                }
                window.location.href = "index2.html"; // Przekierowanie na index2.html
            } else {
                window.location.href = "oszust.html"; // Przekierowanie na stronę z błędem
            }
        }

        // Blokowanie prawokliku
        document.addEventListener("contextmenu", function(event) {
            event.preventDefault();
        });

        // Blokowanie skrótów klawiszowych (Ctrl + U, F12, itp.)
        document.addEventListener("keydown", function(event) {
            if (
                event.key === "F12" ||
                (event.ctrlKey && event.key === "U") ||
                (event.ctrlKey && event.shiftKey && event.key === "I") ||
                (event.ctrlKey && event.shiftKey && event.key === "J") ||
                (event.ctrlKey && event.key === "S") ||
                (event.ctrlKey && event.key === "H") ||
                (event.ctrlKey && event.key === "A") ||
                (event.ctrlKey && event.key === "P")
            ) {
                event.preventDefault();
            }
        });

        // Wykrywanie otwarcia narzędzi programistycznych TYLKO po załadowaniu strony
        setInterval(function() {
            if (window.outerHeight - window.innerHeight > 200 || window.outerWidth - window.innerWidth > 200) {
                document.body.innerHTML = "<h2>Nie oszukasz mnie 😎</h2>";
            }
        }, 500);
    </script>
</body>
</html>
